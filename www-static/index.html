<!DOCTYPE html>
<html><head><title>OpenWRT SUI</title><script type="text/javascript">var t=function(a,b){return function(c,d){return a.replace(/#{([^}]*)}/g,function(a,f){return Function("x","with(x)return "+f).call(c,d||b||{})})}},s=function(a,b){return b?{get:function(c){return a[c]&&b.parse(a[c])},set:function(c,d){a[c]=b.stringify(d)}}:{}}(this.localStorage||{},JSON),p=function(a,b,c,d){c=c||document;d=c[b="on"+b];a=c[b]=function(e){d=d&&d(e=e||c.event);return(a=a&&b(e))?b:d};c=this},m=function(a,b,c){b=document;c=b.createElement("p");c.innerHTML=a;for(a=b.createDocumentFragment();b=c.firstChild;)a.appendChild(b);return a},$=function(a,b){a=a.match(/^(\W)?(.*)/);return(b||document)["getElement"+(a[1]?a[1]=="#"?"ById":"sByClassName":"sByTagName")](a[2])},j=function(a){for(a=0;a<4;a++)try{return a?new ActiveXObject([,"Msxml2","Msxml3","Microsoft"][a]+".XMLHTTP"):new XMLHttpRequest}catch(b){}};</script></head><body><h1>OpenWRT Simple User Interface</h1><form><fieldset><legend>WiFi Setup</legend><ul id="errors"></ul><table><tr><td><label>WiFi Name</label></td><td><input type="text" id="ssid" disabled="true" /></td></tr><tr><td><label>WiFi Password</label></td><td><input type="text" id="psk" disabled="true" /></td></tr></table><input type="submit" value="Loading..." id="ws" disabled="true" /></fieldset></form><script type="text/javascript">var ors=function(a){return function(){d=JSON.parse(a.responseText);$('#errors').innerHTML='';if(d.hasOwnProperty('errors')){var i;for(i=0;i<d.errors.length;i++){$('#errors').appendChile(m('<li>'+d.errord[i]+'</li>'));}}$('#ssid').nodeValue=d.ssid;$('#psk').nodeValue=d.psk;$('#ws').nodeValue='Apply';$('#ssid').disabled=false;$('#psk').disabled=false;$('#ws').disabled=false;};};var dis=function(a){$('#ws').disabled=true;$('#ssid').disabled=true;$('#psk').disabled=true;$('#ws').nodeValue=a;};var url='/cgi-bin/wifi.cgi';b($('#ws'),'click',function(a){dis('Applying...');a=new j();a.open("POST",url,false);a.onreadystatechange=ors(a);a.send('{"ssid":"'+$('#ssid').nodeValue+'","psk":"'+$('#psk').nodeValue+'"}');});b(document,'load',function(a){dis('Retrieving...');a=new j();a.open("GET",url,false);a.onreadystatechange=ors(a);a.send();});</script></body></html>
